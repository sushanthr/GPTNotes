<mxfile host="app.diagrams.net" modified="2024-07-21T19:38:07.987Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 Edg/128.0.0.0" etag="zXiPSFDYmcFzXPN9kZW4" version="24.7.1" type="github">
  <diagram name="Page-1" id="XNl8anMvCdZQgOmeoOen">
    <mxGraphModel dx="3495" dy="2838" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-88" value="Single head of attention" style="group;fillColor=#dae8fc;strokeColor=#6c8ebf;gradientColor=none;rounded=0;perimeterSpacing=0;dashed=1;spacingTop=-25;spacing=0;spacingLeft=0;treeFolding=1;fontStyle=1;fontSize=13;noLabel=0;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="277" y="323" width="450" height="490" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" source="Mk_iKz1ua9PjmVDizpKL-18" target="Mk_iKz1ua9PjmVDizpKL-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" source="Mk_iKz1ua9PjmVDizpKL-18" target="Mk_iKz1ua9PjmVDizpKL-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" source="Mk_iKz1ua9PjmVDizpKL-18" target="Mk_iKz1ua9PjmVDizpKL-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-33" value="linear n_embd -&amp;gt; head_size (6)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Mk_iKz1ua9PjmVDizpKL-32" vertex="1" connectable="0">
          <mxGeometry x="-0.6941" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" source="Mk_iKz1ua9PjmVDizpKL-18" target="Mk_iKz1ua9PjmVDizpKL-36" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="164.99999999999991" y="15" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" source="Mk_iKz1ua9PjmVDizpKL-18" target="Mk_iKz1ua9PjmVDizpKL-37" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="209.99999999999991" y="15" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" source="Mk_iKz1ua9PjmVDizpKL-18" target="Mk_iKz1ua9PjmVDizpKL-43" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="299.9999999999999" />
              <mxPoint x="299.9999999999999" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" source="Mk_iKz1ua9PjmVDizpKL-18" target="Mk_iKz1ua9PjmVDizpKL-38" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="129.99999999999994" y="45" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="259.9999999999999" y="15" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-35" value="linear n_embd -&amp;gt; head_size (6)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Mk_iKz1ua9PjmVDizpKL-34" vertex="1" connectable="0">
          <mxGeometry x="-0.6941" y="2" relative="1" as="geometry">
            <mxPoint x="107" y="32" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-87" value="" style="group" parent="Mk_iKz1ua9PjmVDizpKL-88" vertex="1" connectable="0">
          <mxGeometry y="125" width="449.99999999999983" height="365" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-25" value="Query H" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-26" value="Query i" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry y="50" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-27" value="Query !" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry y="100" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-36" value="Key H" style="rounded=0;whiteSpace=wrap;html=1;direction=south;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="149.99999999999994" width="29.999999999999993" height="130" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-37" value="Key i" style="rounded=0;whiteSpace=wrap;html=1;direction=south;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="194.99999999999991" width="29.999999999999993" height="130" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-38" value="Key !" style="rounded=0;whiteSpace=wrap;html=1;direction=south;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="244.99999999999994" width="29.999999999999993" height="130" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-41" value="Value H" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="329.99999999999983" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-42" value="Value i" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="329.99999999999983" y="50" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-43" value="Value !" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="329.99999999999983" y="100" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-47" value="q @ transpose(k)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="79.99999999999999" y="160" width="109.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-48" value="masked fill tril" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="84.99999999999997" y="190" width="89.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-49" value="softmax" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="99.99999999999997" y="220" width="59.999999999999986" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-50" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;rotation=-90;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="124.99999999999997" y="15" width="19.999999999999996" height="270" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-51" value="w HH" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="59.999999999999986" y="250" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-52" value="w Hi" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="59.999999999999986" y="290" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-53" value="w H!" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="59.999999999999986" y="330" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-54" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="104.99999999999996" y="250" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-55" value="w ii" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="104.99999999999996" y="290" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-56" value="w i!" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="104.99999999999996" y="330" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-57" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="149.99999999999994" y="250" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-58" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="149.99999999999994" y="290" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-59" value="w !!" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="149.99999999999994" y="330" width="39.99999999999999" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-60" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;width=2;endSize=3.44;endWidth=8;" parent="Mk_iKz1ua9PjmVDizpKL-87" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="39.99999999999999" y="365" as="sourcePoint" />
            <mxPoint x="19.999999999999996" y="320" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-61" value="head size 6" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Mk_iKz1ua9PjmVDizpKL-60" vertex="1" connectable="0">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint x="-9" y="-3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-63" value="@" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="244.99999999999994" y="290" width="29.601769911504427" height="29.601769911504427" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-65" value="" style="endArrow=classic;html=1;rounded=0;" parent="Mk_iKz1ua9PjmVDizpKL-87" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="379.99999999999994" y="150" as="sourcePoint" />
            <mxPoint x="259.9999999999999" y="280" as="targetPoint" />
            <Array as="points">
              <mxPoint x="379.99999999999994" y="200" />
              <mxPoint x="259.9999999999999" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-83" value="(T x head_size)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Mk_iKz1ua9PjmVDizpKL-65" vertex="1" connectable="0">
          <mxGeometry x="-0.232" y="2" relative="1" as="geometry">
            <mxPoint x="-4" y="-12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-66" value="" style="endArrow=classic;html=1;rounded=0;" parent="Mk_iKz1ua9PjmVDizpKL-87" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="199.99999999999994" y="305" as="sourcePoint" />
            <mxPoint x="239.99999999999994" y="305" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-85" value="(T x T)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Mk_iKz1ua9PjmVDizpKL-66" vertex="1" connectable="0">
          <mxGeometry x="-0.1" y="4" relative="1" as="geometry">
            <mxPoint y="-11" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-68" value="" style="endArrow=classic;html=1;rounded=0;" parent="Mk_iKz1ua9PjmVDizpKL-87" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="283.99999999999983" y="304" as="sourcePoint" />
            <mxPoint x="323.9999999999999" y="304" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-86" value="(T x head_size)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Mk_iKz1ua9PjmVDizpKL-68" vertex="1" connectable="0">
          <mxGeometry x="-0.2" y="1" relative="1" as="geometry">
            <mxPoint x="10" y="17" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-80" value="head out H" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="329.99999999999983" y="230" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-81" value="head out i" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="329.99999999999983" y="280" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-82" value="head out !" style="rounded=0;whiteSpace=wrap;html=1;" parent="Mk_iKz1ua9PjmVDizpKL-87" vertex="1">
          <mxGeometry x="329.99999999999983" y="330" width="119.99999999999997" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-95" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-87" source="Mk_iKz1ua9PjmVDizpKL-18" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="10" y="-110" as="sourcePoint" />
            <mxPoint x="330" y="15" as="targetPoint" />
            <Array as="points">
              <mxPoint x="300" y="-125" />
              <mxPoint x="300" y="15" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-99" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="Mk_iKz1ua9PjmVDizpKL-88" target="Mk_iKz1ua9PjmVDizpKL-42" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
            <mxPoint x="330" y="140" as="targetPoint" />
            <Array as="points">
              <mxPoint x="300" />
              <mxPoint x="300" y="190" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-100" value="linear n_embed -&amp;gt; head_size (6)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Mk_iKz1ua9PjmVDizpKL-99" vertex="1" connectable="0">
          <mxGeometry x="0.4502" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-1" target="Mk_iKz1ua9PjmVDizpKL-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="147" y="143" />
              <mxPoint x="247" y="143" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-1" value="H" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="127" y="83" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="257" y="153" as="targetPoint" />
            <Array as="points">
              <mxPoint x="211" y="133" />
              <mxPoint x="258" y="133" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-2" value="i" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="177" y="83" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-3" target="Mk_iKz1ua9PjmVDizpKL-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="272" y="103" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-3" value="!" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="227" y="83" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-4" target="Mk_iKz1ua9PjmVDizpKL-19" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="247" y="258" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-4" value="Token Embedding Table" style="shape=internalStorage;whiteSpace=wrap;html=1;backgroundOutline=1;" parent="1" vertex="1">
          <mxGeometry x="197" y="153" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-5" target="Mk_iKz1ua9PjmVDizpKL-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-5" value="Positional Embedding&amp;nbsp;&lt;div&gt;Table&lt;/div&gt;" style="shape=internalStorage;whiteSpace=wrap;html=1;backgroundOutline=1;" parent="1" vertex="1">
          <mxGeometry x="317" y="153" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-10" value="0,1,2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="337" y="103" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-14" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-10" target="Mk_iKz1ua9PjmVDizpKL-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="557" y="593" as="sourcePoint" />
            <mxPoint x="607" y="543" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-18" value="T (3) x n_embd (384)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="127" y="293" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-19" target="Mk_iKz1ua9PjmVDizpKL-18" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="302" y="283" />
              <mxPoint x="187" y="283" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-19" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="287" y="243" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-104" value="concat along token dimension&amp;nbsp;" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;direction=north;" parent="1" vertex="1">
          <mxGeometry x="257" y="833" width="480" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-108" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-105" target="Mk_iKz1ua9PjmVDizpKL-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-105" value="Multi Headed Attention (n_head*T x head_size)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="359.5" y="863" width="275" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-110" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="Mk_iKz1ua9PjmVDizpKL-107" target="Mk_iKz1ua9PjmVDizpKL-109" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-107" value="Linear (n_head*T x head_size -&amp;gt; n_embd)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="359.5" y="933" width="275" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Mk_iKz1ua9PjmVDizpKL-109" value="output n_embd" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="472" y="1013" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-7" value="&lt;div&gt;Mutliheaded Attention&lt;/div&gt;Input: T x n_embed&lt;div&gt;Output: n_embed&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="557" y="1013" width="145" height="50" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-22" value="Block" style="group;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;spacingTop=-28;align=left;" vertex="1" connectable="0" parent="1">
          <mxGeometry x="903" y="359" width="762" height="84" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-22" source="GyelALm-Ci6SsUnXTWCS-8" target="GyelALm-Ci6SsUnXTWCS-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-8" value="T x n_embed" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-22">
          <mxGeometry y="4.66" width="70" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-22" source="GyelALm-Ci6SsUnXTWCS-9" target="GyelALm-Ci6SsUnXTWCS-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-17" value="Txn_embed" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="GyelALm-Ci6SsUnXTWCS-13">
          <mxGeometry x="0.1917" y="-2" relative="1" as="geometry">
            <mxPoint x="-13" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-9" value="Layer Norm" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-22">
          <mxGeometry x="84.99560283687943" y="12.5" width="46.431560283687936" height="53.33" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-22" source="GyelALm-Ci6SsUnXTWCS-10" target="GyelALm-Ci6SsUnXTWCS-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-16" value="n_embed" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="GyelALm-Ci6SsUnXTWCS-14">
          <mxGeometry x="-0.1758" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-10" value="Multiheaded Attention" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-22">
          <mxGeometry x="209.00264345583489" y="15.333333333333332" width="92.36363636363635" height="53.33333333333333" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-11" value="Layer Norm" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-22">
          <mxGeometry x="365.6879432624113" y="13.33" width="49.539007092198574" height="54.67" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-20" value="&amp;nbsp;n_embed" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-22">
          <mxGeometry x="683" y="4.17" width="70" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-42" value="GPT Model" style="group;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;spacingTop=-27;align=left;" vertex="1" connectable="0" parent="1">
          <mxGeometry x="901.5" y="492" width="765" height="120" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-42" source="GyelALm-Ci6SsUnXTWCS-23" target="GyelALm-Ci6SsUnXTWCS-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-36" value="n_embed" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="GyelALm-Ci6SsUnXTWCS-30">
          <mxGeometry x="-0.0392" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-23" value="Block" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="100" y="23" width="55" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-47" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-42" source="GyelALm-Ci6SsUnXTWCS-24" target="GyelALm-Ci6SsUnXTWCS-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-24" value="T x n_embed" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry y="18" width="70" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-42" source="GyelALm-Ci6SsUnXTWCS-25" target="GyelALm-Ci6SsUnXTWCS-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-35" value="n_embed" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="GyelALm-Ci6SsUnXTWCS-34">
          <mxGeometry x="0.0441" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-25" value="Block" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="230" y="23" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-31" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;direction=north;size=0.5;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="91" y="82" width="204" height="20" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-32" value="n_layers number of sequential blocks" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="78" y="95" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-38" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-42" source="GyelALm-Ci6SsUnXTWCS-33" target="GyelALm-Ci6SsUnXTWCS-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-33" value="Layer Norm" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="365" y="23" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="GyelALm-Ci6SsUnXTWCS-42" source="GyelALm-Ci6SsUnXTWCS-37" target="GyelALm-Ci6SsUnXTWCS-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-37" value="Linear n_embed -&amp;gt; vocab_size" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="465" y="23" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-39" value="vocab_size" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="693.5" y="18.5" width="70" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-40" value="logits" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-42">
          <mxGeometry x="700" y="88" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-43" value="Nano GPT" style="text;strokeColor=none;fillColor=none;html=1;fontSize=24;fontStyle=1;verticalAlign=middle;align=center;" vertex="1" parent="1">
          <mxGeometry x="39" y="21" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-6" value="Feedforward (n_embd -&gt; n_embd)" style="group;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;spacingTop=-29;expand=1;collapsible=1;" vertex="1" connectable="0" parent="1">
          <mxGeometry x="1367.0018181818182" y="260" width="170.9090909090909" height="80" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-3" value="Linear (n_embd -&amp;gt; 4 * n_embd)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;expand=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-6">
          <mxGeometry width="170.9090909090909" height="26.666666666666664" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-4" value="Linear (4 * n_embd &amp;gt; n_embd)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;expand=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-6">
          <mxGeometry y="53.33333333333333" width="170.9090909090909" height="26.666666666666664" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-5" value="Relu" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;expand=1;" vertex="1" parent="GyelALm-Ci6SsUnXTWCS-6">
          <mxGeometry y="26.666666666666664" width="51.272727272727266" height="26.666666666666664" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="GyelALm-Ci6SsUnXTWCS-11" target="GyelALm-Ci6SsUnXTWCS-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GyelALm-Ci6SsUnXTWCS-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="GyelALm-Ci6SsUnXTWCS-4" target="GyelALm-Ci6SsUnXTWCS-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
